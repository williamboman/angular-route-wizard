/*
	angular-route-wizard v0.0.1-beta.2
	https://github.com/williamboman/angular-route-wizard

	(c) 2014 William Boman <william@redwill.se>
*/

!function(a){"use strict";var b=a.module("wb.ngRouteWizard",["ngRoute"]);b.provider("urlWizard",["$routeProvider",function(b){function c(a){return/^:[\w\d]+\??/.test(a)}function d(a){return/\?$/.test(a)}function e(a){return d(a)?a.slice(1,-1):a.substr(1)}var f=this,g={};this.pathPropertyName="path",this.init=function(c){return a.forEach(c,function(a,c){if("undefined"==typeof a[f.pathPropertyName])throw new ReferenceError('[wb.ngRouteWizard] Route "'+c+'" is missing path property.');var d=a[f.pathPropertyName];b.when(d,a),g[c]=a}),this},this.$get=["$location",function(b){function h(){}return h.prototype.to=function(h,i,j){"object"!=typeof i&&(i={});var k=g[h];if("undefined"==typeof k)throw new ReferenceError("[wb.ngRouteWizard] Unable to generate a url to the route '"+h+"': Specified route doesn't exist.");for(var l=k[f.pathPropertyName];/^\/+/.test(l);)l=l.substr(1);var m=[];l.length>0&&(m=l.split("/"));var n=[];return a.forEach(m,function(a){if(c(a)){var b=e(a);if(["string","number"].indexOf(typeof i[b])>=0)n.push(i[b]);else if(!d(a))throw new TypeError("[wb.ngRouteWizard] Unable to generate a url to the route '"+h+"': Missing/invalid mandatory route parameter ("+b+").")}else n.push(a)}),(j===!0?b.$$absUrl:"")+n.join("/")},new h}]}]),b.directive("wizRoute",["urlWizard","$location",function(a,b){return{restrict:"A",link:function(c,d,e){var f,g=e.wizRoute,h=e.wizParams;if("undefined"!=typeof h)try{f=JSON.parse(h)}catch(i){throw new Error("[wb.ngRouteWizard] Could not parse wiz-params. ["+h+"]")}d[0].href=(b.$$html5?"":"#/")+a.to(g,f)}}}])}(window.angular);